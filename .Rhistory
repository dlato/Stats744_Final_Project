#theme(plot.title = element_text(hjust = 0.5),
theme(plot.title = element_text(),
panel.background = element_rect(fill = "white", colour = NA),
panel.grid.major = element_line(colour = "grey90", size = 0.2),
panel.grid.minor = element_line(colour = "grey98", size = 0.5),
panel.spacing = unit(0.25, "lines"),
axis.text=element_text(size=10),
legend.title = element_blank(),
legend.key = element_blank(),
legend.background=element_blank(),
legend.position="top")
)
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black")
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
#+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
)
#choose colours
#colours_arr <- c("#CFE7C8","#D2E4DC","#A0747A")
#colours_arr <- c("#7A306C","#8E8DBE","#5EB26D")
colours_arr <- c("#A0747A","#5EB26D","#8E8DBE")
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black")
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
#+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
)
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black")
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
#+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=2)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
#+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
#+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
#plot just ecoli
ecol_dat <- median_sel_dat[which(median_sel_dat$bacteria == "strep"),]
head(ecol_dat)
#scale the genomic position
ecol_dat$new_sections <- ecol_dat$new_sections / 1000000
# The errorbars overlapped, so use position_dodge to move them horizontally
pd <- position_dodge(0.1) # move them .05 to the left and right
ecol_dat$class <- factor(ecol_dat$class, levels = c("dS", "omega", "dN"))
#choose colours
#colours_arr <- c("#CFE7C8","#D2E4DC","#A0747A")
#colours_arr <- c("#7A306C","#8E8DBE","#5EB26D")
colours_arr <- c("#A0747A","#5EB26D","#8E8DBE")
colours_arr <- c("#8E8DBE","#A0747A","#5EB26D")
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
#+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
(ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
install.packages("ggthemes")
library(directlabels)
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
direct.label(distg,method="last.points")
levels(ecol_dat$class) <- c("dS" = " dS",
"omega" = expression(omega),
"dN" = " dN")
#choose colours
#colours_arr <- c("#CFE7C8","#D2E4DC","#A0747A")
#colours_arr <- c("#7A306C","#8E8DBE","#5EB26D")
colours_arr <- c("#A0747A","#5EB26D","#8E8DBE")
colours_arr <- c("#8E8DBE","#A0747A","#5EB26D")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
direct.label(distg,method="last.points")
levels(ecol_dat$class)
levels(ecol_dat$class) <- c("dS" = " dS",
"omega" = "expression(omega)",
"dN" = " dN")
levels(ecol_dat$class)
#choose colours
#colours_arr <- c("#CFE7C8","#D2E4DC","#A0747A")
#colours_arr <- c("#7A306C","#8E8DBE","#5EB26D")
colours_arr <- c("#A0747A","#5EB26D","#8E8DBE")
colours_arr <- c("#8E8DBE","#A0747A","#5EB26D")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
direct.label(distg,method="last.points")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=n_gram), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=value.mean, se=F)
+ geom_dl(aes(label=n_gram), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=0.3, se=F)
+ geom_dl(aes(label=n_gram), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=n_gram), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
span = 0.3
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=n_gram), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
direct.label(distg,method="last.points")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=class), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("E.coli"), " Chromosome")))
)
direct.label(distg,method="last.points")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=class), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("Streptomyces"), " Chromosome")), hjust = 0.5)
)
theme_set(theme_bw() + theme(strip.background =element_rect(fill="#e7e5e2")) +
theme(strip.text = element_text(size =10)) +
#theme(plot.title = element_text(hjust = 0.5),
theme(plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill = "white", colour = NA),
panel.grid.major = element_line(colour = "grey90", size = 0.2),
panel.grid.minor = element_line(colour = "grey98", size = 0.5),
panel.spacing = unit(0.25, "lines"),
axis.text=element_text(size=10),
legend.title = element_blank(),
legend.key = element_blank(),
legend.background=element_blank(),
legend.position="top")
)
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=class), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("Streptomyces"), " Chromosome")), hjust = 0.5)
)
direct.label(distg,method="last.points")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
#  + geom_smooth(method = lm)
+ stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=class), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("Streptomyces"), " Chromosome")))
)
direct.label(distg,method="last.points")
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
#  + stat_smooth(size=2, span=span, se=F)
+ geom_dl(aes(label=class), method = "last.qp", stat="smooth", span=span)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("Streptomyces"), " Chromosome")))
)
direct.label(distg,method="last.points")
warnings()
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("Streptomyces"), " Chromosome")))
)
direct.label(distg,method="last.points")
levels(ecol_dat$class) <- c("dS" = " dS",
"omega" = expression(omega),
"dN" = " dN")
levels(ecol_dat$class)
#choose colours
#colours_arr <- c("#CFE7C8","#D2E4DC","#A0747A")
#colours_arr <- c("#7A306C","#8E8DBE","#5EB26D")
colours_arr <- c("#A0747A","#5EB26D","#8E8DBE")
colours_arr <- c("#8E8DBE","#A0747A","#5EB26D")
span = 0.3
distg <- (ggplot(ecol_dat, aes(x=new_sections, y=value.mean, colour=class))
#  geom_errorbar(aes(ymin=value.mean-sd, ymax=value.mean+sd), width=.1, position=pd) +
+ geom_point()
+ geom_smooth(method = lm)
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "black", size=1)
#+ scale_color_manual(values=colours_arr,labels = c(" dS", " dN", expression(omega)))
#+ scale_color_manual(values=colours_arr,labels = c(" dS", expression(omega), " dN"))
+ scale_color_manual(values=colours_arr)
#axis labels
+ xlab("Genome Position (Mbp)")
+ ylab("Mean Value")
+ ggtitle(expression(paste(italic("Streptomyces"), " Chromosome")))
)
direct.label(distg,method="last.points")
direct.label(distg)
direct.label(distg, method = "last")
direct.label(distg, method = "last.line")
direct.label(distg,method="last.points")
#italic bacteria names
levels(sel_dat$bacteria) <- c("ecoli" = expression(paste(italic("E.coli"), "")),
"bass" = expression(paste(italic("B. subtilis"), "")),
"strep" = expression(paste(italic("Streptomyces"), "")),
"sinoC" = expression(paste(italic("S.meliloti"), " Chromosome")),
"pSymA" = expression(paste(italic("S.meliloti"), " pSymA")),
"pSymB" = expression(paste(italic("S.meliloti"), " pSymB")))
#choose colours
colours_arr <- rep(c("#CFE7C8","#D2E4DC","#A0747A"),num_of_plots)
#plot
set.seed(1738)
vio_str_box <-(ggplot(sel_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
#+ geom_boxplot(width=.1, outlier.shape=NA, fill = colours_arr)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "#023C40")
+ facet_wrap(~bacteria, labeller=label_parsed)
+ xlab("")
+ ylab("Value")
+ scale_color_manual(values=c("#CFE7C8","#D2E4DC","#A0747A"),labels = c(" dN", " dS", expression(omega)))
#+ scale_color_manual(values=c("#CFE7C8","#D2E4DC","#A0747A"))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("dN", "dS", "omega"),labels = c("dN","dS", expression(omega)))
#log scale and removing trailing zeros from y-axis labels
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#+ scale_fill_manual(values=c("#CFE7C8","#D2E4DC","#A0747A"), labels = c(" dN", " dS", expression(omega)))
)
vio_str_box
levels(sel_dat)
levels(sel_dat$bacteria)
#read in data'
sel_dat <- read.csv("./data/all_bac_selection_data.csv", header = FALSE)
#drop first column because it is just the row numbers
sel_dat <- sel_dat[,-1]
#col names
colnames(sel_dat) <- c("value", "position", "class", "bacteria")
#remove NAs
sel_dat <- sel_dat[!is.na(sel_dat$value),]
#number of bacterial replicons
num_of_plots <- length(levels(sel_dat$bacteria))
levels(sel_dat$bacteria)
#italic bacteria names
levels(sel_dat$bacteria) <- c("ecoli" = expression(paste(italic("E.coli"), "")),
"bass" = expression(paste(italic("B. subtilis"), "")),
"strep" = expression(paste(italic("Streptomyces"), "")),
"sinoC" = expression(paste(italic("S.meliloti"), " Chromosome")),
"pSymA" = expression(paste(italic("S.meliloti"), " pSymA")),
"pSymB" = expression(paste(italic("S.meliloti"), " pSymB")))
#choose colours
colours_arr <- rep(c("#CFE7C8","#D2E4DC","#A0747A"),num_of_plots)
#plot
set.seed(1738)
vio_str_box <-(ggplot(sel_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
#+ geom_boxplot(width=.1, outlier.shape=NA, fill = colours_arr)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
#omega = 1 reference line
+  geom_hline(yintercept=1, linetype="dashed", color = "#023C40")
+ facet_wrap(~bacteria, labeller=label_parsed)
+ xlab("")
+ ylab("Value")
+ scale_color_manual(values=c("#CFE7C8","#D2E4DC","#A0747A"),labels = c(" dN", " dS", expression(omega)))
#+ scale_color_manual(values=c("#CFE7C8","#D2E4DC","#A0747A"))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("dN", "dS", "omega"),labels = c("dN","dS", expression(omega)))
#log scale and removing trailing zeros from y-axis labels
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x))
#+ scale_fill_manual(values=c("#CFE7C8","#D2E4DC","#A0747A"), labels = c(" dN", " dS", expression(omega)))
)
vio_str_box
