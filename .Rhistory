+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#remove all legends
+ theme(legend.position = "none",
#removing space at bottom of plot
plot.margin=unit(c(1,1,-0.5,1)),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_rates_summary <-(ggplot(single_rates_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
+ xlab("")
+ ylab("Expected Number\nof Substitutions\nper Site")
+ scale_color_manual(values=c("#8BC1C1","#928CAB"),labels = c(" dN", " dS"))
+ scale_x_discrete(breaks = c("dN", "dS"),labels = c("dN","dS"))
#log scale and removing trailing zeros from y-axis labels
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#remove all legends
+ theme(legend.position = "none",
#removing space at bottom of plot
plot.margin=unit(c(1,1,-0.5,1), "in"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_rates_summary
single_rates_summary <-(ggplot(single_rates_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
+ xlab("")
+ ylab("Expected Number\nof Substitutions\nper Site")
+ scale_color_manual(values=c("#8BC1C1","#928CAB"),labels = c(" dN", " dS"))
+ scale_x_discrete(breaks = c("dN", "dS"),labels = c("dN","dS"))
#log scale and removing trailing zeros from y-axis labels
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#remove all legends
+ theme(legend.position = "none",
#removing space at bottom of plot
plot.margin=unit(c(2,1,-0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_rates_summary
single_rates_summary <-(ggplot(single_rates_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
+ xlab("")
+ ylab("Expected Number\nof Substitutions\nper Site")
+ scale_color_manual(values=c("#8BC1C1","#928CAB"),labels = c(" dN", " dS"))
+ scale_x_discrete(breaks = c("dN", "dS"),labels = c("dN","dS"))
#log scale and removing trailing zeros from y-axis labels
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#remove all legends
+ theme(legend.position = "none",
#removing space at bottom of plot
plot.margin=unit(c(1,1,-0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_rates_summary
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(1,1,-0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
### summary graph for omega values for non-multi-rep bacteria
colours_arr <- rep(c("#B18C6E"), num_of_plots/2)
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(1,1,1,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
#arrange the graphs for non-multi rep bac
grid.newpage()
grid.draw(rbind(ggplotGrob(single_rates_summary), ggplotGrob(single_omega_summary)))
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(-0.5,1,1,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
#arrange the graphs for non-multi rep bac
grid.newpage()
grid.draw(rbind(ggplotGrob(single_rates_summary), ggplotGrob(single_omega_summary)))
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0,1,-0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0.5,1,-0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0.5,1,1,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0.5,1,0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
#arrange the graphs for non-multi rep bac
grid.newpage()
grid.draw(rbind(ggplotGrob(single_rates_summary), ggplotGrob(single_omega_summary)))
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0.3,1,0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
single_omega_summary
#arrange the graphs for non-multi rep bac
grid.newpage()
grid.draw(rbind(ggplotGrob(single_rates_summary), ggplotGrob(single_omega_summary)))
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0.2,1,0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
#arrange the graphs for non-multi rep bac
grid.newpage()
grid.draw(rbind(ggplotGrob(single_rates_summary), ggplotGrob(single_omega_summary)))
single_omega_summary <-(ggplot(single_omega_dat, aes(x=class, y=value, fill = class, colour = class))
+ geom_jitter(position=position_jitter(0.2))
+ geom_violin(colour = "black", fill = NA)
+ geom_boxplot(width=.1, outlier.shape=NA, colour = "black", fill = colours_arr)
+ stat_boxplot(geom = "errorbar", width = 0.2, colour = "black")
+ facet_wrap(~bacteria, labeller=label_parsed)
#omega = 1 reference line only on the omega data
+  geom_hline(data = data.frame(yint=1,fake_class="ome"), aes(yintercept= yint), linetype="dashed", color = "black")
+ xlab("")
+ ylab("Ratio of dN/dS")
+ scale_color_manual(values=c("#C29979"),labels = c(expression(omega)))
#make the omega a math symbol in x-axis
+ scale_x_discrete(breaks = c("omega"),labels = c(expression(omega)))
#log scale and removing trailing zeros from y-axis labels
##remove the axis ticks
#+ theme(axis.ticks.y = element_blank(),
#        axis.title.y = element_blank(),
#        axis.text.y = element_blank() )
#and have label at omega = 1 for reference
+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000))
#+ scale_y_continuous(trans='log10',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000),
#                  #adding a second axis for omega!
#                    sec.axis = sec_axis(trans = ~ . * 1,
#                                       name = 'Ratio of dN/dS \n',labels = function(x) ifelse(x == 0, "0", x), breaks=c(0.001,0.1, 1, 10,1000)))
#remove all legends and facet labels (redundant)
+ theme(legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_blank(),
#specify plot margins
plot.margin=unit(c(0.1,1,0.5,1), "cm"),
#remove space between facest
panel.spacing.x=unit(0, "lines"))
)
#arrange the graphs for non-multi rep bac
grid.newpage()
grid.draw(rbind(ggplotGrob(single_rates_summary), ggplotGrob(single_omega_summary)))
library(tidyverse)
library(data.table)
library(devtools)
library(cowplot)
library(ggpubr)
library(plyr)
library(dplyr)
library(directlabels)
library(formatR)
library(gridExtra)
library(grid)
options(scipen=10000)
#setting up a theme so all graphs are consistant
theme_set(theme_bw() + theme(strip.background =element_rect(fill="#e7e5e2")) +
theme(strip.text = element_text(size =15)) +
theme(plot.title = element_text(hjust = 0.5, size = 18),
panel.background = element_rect(fill = "white", colour = NA),
panel.grid.major = element_line(colour = "grey90", size = 0.2),
panel.grid.minor = element_line(colour = "grey98", size = 0.5),
panel.spacing = unit(0.25, "lines"),
axis.text=element_text(size=18),
axis.title = element_text(size = 18),
#for second legend on y-axis
axis.text.y.right = element_text(size=18),
legend.title = element_blank(),
legend.text = element_text(size = 18),
#change the colour of facet label background
strip.background = element_rect(fill = "#E6E1EA"),
#remove space between facest
panel.spacing.x=unit(0, "lines"),
legend.key = element_blank(),
legend.background=element_blank(),
legend.position="top")
)
#prevent overflow of code boxes
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=70),tidy=TRUE,fig.width=10, fig.height=7)
#read in data'
sel_dat <- read.csv("./data/all_bac_selection_data.csv", header = FALSE)
#drop first column because it is just the row numbers
sel_dat <- sel_dat[,-1]
#col names
colnames(sel_dat) <- c("value", "position", "class", "bacteria")
#remove NAs
sel_dat <- sel_dat[!is.na(sel_dat$value),]
#number of bacterial replicons
num_of_plots <- length(levels(sel_dat$bacteria))
###################################
#########################
#chunking the data into sections of the genome
#########################
#decreasing order
sel_dat_ord <- arrange(sel_dat,position)
nmax_pos <- max(sel_dat_ord$position)
nmin_pos <- min(sel_dat_ord$position)
#lenght of section of genome
chunklen <- 10000
chunk_len_of_genome <- round_any(nmax_pos, chunklen, f=ceiling)
chunks <- seq(chunklen, chunk_len_of_genome, chunklen)
#expty vec to hold the rows that split the dat into X kb chunks
exp_rows_to_split_dat <- vector()
diff <- c(exp_rows_to_split_dat[-1],NA)
tmp_df <- as.data.frame(cbind(exp_rows_to_split_dat,diff))
tmp_df$rep_vec <- tmp_df$diff - tmp_df$exp_rows_to_split_dat
#make rep vector
rep_vec <- c(exp_rows_to_split_dat[1],tmp_df$rep_vec[-length(tmp_df$rep_vec)])
rep_vec
#make new column with "groups" of these chunks
new_sections <- rep(chunks, rep_vec)
sel_dat_ord$new_sections <- new_sections
#mean for each genome chunk
median_sel_dat <- sel_dat_ord %>%
dplyr::group_by(bacteria,class,new_sections) %>%
dplyr::summarise(value.mean = mean(value), value.sd = sd(value))
#remove NAs
median_sel_dat <- tidyr::drop_na(median_sel_dat)
#plot just strep
strep_dat <- median_sel_dat[which(median_sel_dat$bacteria == "strep"),]
#scale the genomic position
strep_dat$new_sections <- strep_dat$new_sections / 1000000
###get separate datasets for the rates and omega
rates_dat <- sel_dat[which(sel_dat$class == "dN" | sel_dat$class == "dS"),]
omega_dat <- sel_dat[which(sel_dat$class == "omega"),]
### separate those again by the non-multirepliconic and multirepliconic bacteria
single_rates_dat <- rates_dat[which(rates_dat$bacteria == "ecoli" | rates_dat$bacteria == "bass" | rates_dat$bacteria == "strep"),]
levels(single_rates_dat$bacteria)
